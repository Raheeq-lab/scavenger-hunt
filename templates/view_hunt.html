<!DOCTYPE html>
<html>
<head>
    <title>View Hunt - {{ hunt.name }}</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Arial', sans-serif; background: #f5f7fa; color: #333; }
        .navbar { background: linear-gradient(135deg, #4CAF50 0%, #2E7D32 100%); color: white; padding: 20px 40px; display: flex; justify-content: space-between; align-items: center; }
        .logo { font-size: 1.8em; font-weight: bold; display: flex; align-items: center; gap: 10px; }
        .nav-links { display: flex; gap: 20px; align-items: center; }
        .nav-link { color: white; text-decoration: none; padding: 8px 15px; border-radius: 5px; transition: background 0.3s; }
        .nav-link:hover { background: rgba(255,255,255,0.1); }
        .container { max-width: 1000px; margin: 40px auto; padding: 0 20px; }
        .back-link { display: inline-flex; align-items: center; gap: 8px; color: #666; text-decoration: none; margin-bottom: 20px; }
        .hunt-header { background: white; border-radius: 15px; padding: 30px; margin-bottom: 30px; box-shadow: 0 5px 15px rgba(0,0,0,0.05); border-left: 5px solid #4CAF50; }
        .hunt-title { font-size: 2em; color: #333; margin-bottom: 10px; display: flex; align-items: center; gap: 15px; }
        .hunt-description { color: #666; line-height: 1.6; margin-bottom: 20px; }
        .hunt-meta { display: flex; gap: 30px; color: #777; font-size: 0.9em; }
        .questions-section { background: white; border-radius: 15px; padding: 30px; box-shadow: 0 5px 15px rgba(0,0,0,0.05); margin-bottom: 30px; }
        .section-title { font-size: 1.5em; color: #333; margin-bottom: 25px; display: flex; align-items: center; gap: 10px; }
        .question-item { background: #f8f9fa; border-radius: 10px; padding: 20px; margin-bottom: 15px; border-left: 4px solid #2196F3; }
        .question-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
        .question-type { background: #e3f2fd; color: #2196F3; padding: 3px 10px; border-radius: 20px; font-size: 0.8em; font-weight: bold; }
        .question-text { color: #444; margin-bottom: 15px; line-height: 1.5; }
        .question-details { background: #fff; padding: 15px; border-radius: 8px; margin-top: 10px; }
        .detail-row { display: flex; margin-bottom: 8px; }
        .detail-label { font-weight: bold; width: 150px; color: #666; }
        .qr-section { background: white; border-radius: 15px; padding: 30px; box-shadow: 0 5px 15px rgba(0,0,0,0.05); }
        .qr-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 20px; margin-top: 20px; }
        .qr-item { text-align: center; padding: 15px; background: #f8f9fa; border-radius: 10px; }
        .qr-image { max-width: 150px; height: auto; margin-bottom: 10px; border: 2px solid #ddd; border-radius: 8px; }
        .btn { padding: 12px 25px; border: none; border-radius: 8px; font-size: 1em; font-weight: bold; cursor: pointer; transition: all 0.3s; text-decoration: none; display: inline-block; }
        .btn-primary { background: #4CAF50; color: white; }
        .btn-primary:hover { background: #45a049; transform: translateY(-2px); }
        .btn-secondary { background: #f5f5f5; color: #666; border: 1px solid #ddd; }
        .btn-secondary:hover { background: #e0e0e0; }
        .button-group { display: flex; gap: 15px; margin-top: 30px; }
        .status-badge {
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.9em;
            font-weight: bold;
        }
        .status-active { background: #d4edda; color: #155724; }
        .status-inactive { background: #f8d7da; color: #721c24; }
    </style>
</head>
<body>
    <div class="navbar">
        <div class="logo"><span>üéØ</span> Scavenger Hunt</div>
        <div class="nav-links">
            <a href="/teacher/dashboard" class="nav-link">Dashboard</a>
            <a href="/logout" class="nav-link">Logout</a>
        </div>
    </div>
    
    <div class="container">
        <a href="/teacher/dashboard" class="back-link">‚Üê Back to Dashboard</a>
        
        <!-- Hunt Header -->
        <div class="hunt-header">
            <div class="hunt-title">
                <span>üìã</span> {{ hunt.name }}
                <a href="{{ url_for('edit_hunt', hunt_id=hunt.id) }}" class="btn btn-secondary" style="margin-left: 20px; padding: 5px 15px; font-size: 0.6em; vertical-align: middle;">
                    ‚úèÔ∏è Edit Hunt
                </a>
            </div>
            {% if hunt.description %}
            <div class="hunt-description">
                {{ hunt.description }}
            </div>
            {% endif %}
            <div class="hunt-meta">
                <div>Created: {{ hunt.created_at.strftime('%B %d, %Y') if hunt.created_at else 'Recently' }}</div>
                <div>Questions: {{ hunt.questions|length }}</div>
                <div>Status: 
                    <span class="status-badge {% if hunt.is_active %}status-active{% else %}status-inactive{% endif %}">
                        {{ 'Active' if hunt.is_active else 'Inactive' }}
                    </span>
                </div>
            </div>
        </div>
        
        <!-- Questions Section -->
        <div class="questions-section">
            <div class="section-title">
                <span>‚ùì</span> Questions ({{ questions|length }})
            </div>
            
            {% if questions %}
                <table border="1" cellpadding="10" style="width: 100%; border-collapse: collapse; margin-bottom: 20px;">
                    <thead>
                        <tr style="background: #f8f9fa;">
                            <th>#</th>
                            <th>Question</th>
                            <th>Hint</th>
                            <th>Next Location Hint</th>
                            <th>QR Code</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for q in questions %}
                        <tr>
                            <td style="text-align: center; font-weight: bold;">{{ q.order }}</td>
                            <td>{{ q.text[:100] }}{% if q.text|length > 100 %}...{% endif %}</td>
                            <td>{{ q.hint or 'No hint' }}</td>
                            <td>{{ q.next_location_hint or 'No next hint' }}</td>
                            <td style="text-align: center;">
                                <a href="{{ url_for('display_qr', qr_token=q.qr_token) }}" target="_blank" style="background: #4CAF50; color: white; padding: 5px 10px; border-radius: 4px; text-decoration: none;">
                                    View QR Code
                                </a><br>
                                <small style="color: #666;">{{ q.qr_url[:30] }}...</small>
                            </td>
                            <td style="text-align: center;">
                                <a href="{{ url_for('edit_question', question_id=q.id) }}" class="btn btn-secondary" style="padding: 5px 10px; font-size: 0.9em; display: inline-block;">
                                    ‚úèÔ∏è Edit
                                </a>
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            {% else %}
                <div style="text-align: center; padding: 40px; color: #999;">
                    <p>No questions added to this hunt yet.</p>
                    <a href="{{ url_for('add_question', hunt_id=hunt.id) }}" style="display: inline-block; margin-top: 15px; background: #4CAF50; color: white; padding: 10px 20px; text-decoration: none; border-radius: 5px;">
                        + Add First Question
                    </a>
                </div>
            {% endif %}
        </div>
        
        <!-- Action Buttons -->
        <div class="button-group">
            <a href="/teacher/dashboard" class="btn btn-secondary">‚Üê Back to Dashboard</a>
            <a href="{{ url_for('add_question', hunt_id=hunt.id) }}" class="btn btn-primary">
                + Add Question
            </a>
            <button onclick="toggleHuntActive({{ hunt.id }})" class="btn" style="background: {% if hunt.is_active %}#dc3545{% else %}#28a745{% endif %}; color: white;">
                {% if hunt.is_active %}‚õî Deactivate Hunt{% else %}‚úÖ Activate Hunt{% endif %}
            </button>
        </div>
    </div>

    <script>
    function toggleHuntActive(huntId) {
        fetch(`/teacher/hunt/${huntId}/toggle-active`, {
            method: 'POST',
            headers: {'Content-Type': 'application/json'}
        })
        .then(response => response.json())
        .then(data => {
            if(data.success) {
                alert(data.message);
                location.reload();
            }
        })
        .catch(error => {
            alert('Error: ' + error);
        });
    }
    </script>
</body>
</html>
